<html dir="LTR">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
    <meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5" />
    <title>Expr Class</title>
    <xml>
    </xml>
    <link rel="stylesheet" type="text/css" href="MSDN.css" />
  </head>
  <body id="bodyID" class="dtBODY">
    <div id="nsbanner">
						<div id="nsbanner">
						<div id="bannerrow1">
						<table class="bannerparthead" cellspacing="0">
						<tr id="hdr">
						<td class="runninghead">.NET/Link API Version 1.7</td>
						<td class="product"></td>
						<td> <A HREF="index.html?Wolfram.NETLink.Expr.html" target="_top"><B>USE FRAMES</B></A> </td>
						</tr>
						</table>
						</div>
						<div id="TitleRow">
						<h1 class="dtH1">Expr Class</h1>
						</div>
						</div></div>
    <div id="nstext">
      <p> A representation of arbitrary <i>Mathematica</i> expressions in .NET. </p>
      <p>For a list of all members of this type, see <a href="Wolfram.NETLink.ExprMembers.html">Expr Members</a>.</p>
      <p>
        <a href="ms-help://MS.NETFrameworkSDKv1.1/cpref/html/frlrfSystemObjectClassTopic.htm">System.Object</a>
        <br />   <b>Wolfram.NETLink.Expr</b></p>
      <div class="syntax">
        <span class="lang">[Visual Basic]</span>
        <br />NotInheritable Public Class Expr<div>    Implements <a href="ms-help://MS.NETFrameworkSDKv1.1/cpref/html/frlrfSystemIDisposableClassTopic.htm">IDisposable</a>, <a href="ms-help://MS.NETFrameworkSDKv1.1/cpref/html/frlrfSystemRuntimeSerializationISerializableClassTopic.htm">ISerializable</a></div></div>
      <div class="syntax">
        <span class="lang">[C#]</span>
        <div>public sealed class Expr<b> : <a href="ms-help://MS.NETFrameworkSDKv1.1/cpref/html/frlrfSystemIDisposableClassTopic.htm">IDisposable</a>, <a href="ms-help://MS.NETFrameworkSDKv1.1/cpref/html/frlrfSystemRuntimeSerializationISerializableClassTopic.htm">ISerializable</a></b></div>
      </div>
      <H4 class="dtH4">Thread Safety</H4>
      <P>Public static (<b>Shared</b> in Visual Basic) members of this type are 
				safe for multithreaded operations. Instance members are <b>not</b> guaranteed to be 
				thread-safe.</P>
      <h4 class="dtH4">Remarks</h4>
      <p> The Expr class is a representation of arbitrary <i>Mathematica</i> expressions in .NET. Exprs are created by reading an expression from a link (using the <a href="Wolfram.NETLink.IMathLink.GetExpr.html">GetExpr</a> method), they can be decomposed into component Exprs with properties and methods like <a href="Wolfram.NETLink.Expr.Head.html">Head</a> and <a href="Wolfram.NETLink.Expr.Part_overload_1.html">Part</a>, and their structure can be queried with methods like <a href="Wolfram.NETLink.Expr.Length.html">Length</a>, <a href="Wolfram.NETLink.Expr.NumberQ.html">NumberQ</a>, and <a href="Wolfram.NETLink.Expr.VectorQ_overload_1.html">VectorQ</a>. All these methods will be familiar to <i>Mathematica</i> programmers, and their Expr counterparts work similarly. <p> Like <i>Mathematica</i> expressions, Exprs are immutable, meaning they can never be changed once they are created. Operations that might appear to modify an Expr (like <a href="Wolfram.NETLink.Expr.Delete.html">Delete</a>) return new modified Exprs without changing the original. Because Exprs are immutable, they are also thread-safe, meaning that any number of threads can access a given Expr at the same time. </p> Exprs are stored initially in a very efficient way, and they can be created and written to links very quickly. When you call operations that inspect their structure or that extract component parts, however, it is likely that they must be unpacked into a more .NET-native form that requires more memory. <p> In its present state, Expr has four main uses: </p> (1) Storing expressions read from a link so that they can be later written to another link. This use replaces functionality that C-language programmers would use a loopback link for. (.NET/Link has an <a href="Wolfram.NETLink.ILoopbackLink.html">ILoopbackLink</a> interface as well, but Expr affords an even easier method.) <pre class="code">Expr e = ml.GetExpr();
// ... Later, write it to a different MathLink:
otherML.Put(e);
e.Dispose();
</pre> Note that if you just want to move an expression immediately from one link to another, you can use the IMathLink method <a href="Wolfram.NETLink.IMathLink.TransferExpression.html">TransferExpression</a> and avoid creating an Expr to store it. <p> (2) Many of the <a href="Wolfram.NETLink.IKernelLink.html">IKernelLink</a> methods take either a string or an Expr. If it is not convenient to build a string of <i>Mathematica</i> input, you can use an Expr. There are two ways to build an Expr: you can use a constructor, or you can create a loopback link as a scratchpad, build the expression on this link with a series of Put calls, then read the expression off the loopback link using GetExpr. Here is an example that creates an Expr that represents 2+2 and computes it in <i>Mathematica</i> using these two techniques: </p>
            <pre class="code">// First method: Build it using Expr constructors:
Expr symbolPlus = new Expr(ExpressionType.Symbol, "Plus");
Expr e1 = new Expr(symbolPlus, 2, 2);
// ml is a KernelLink
string result = ml.EvaluateToOutputForm(e1, 0);
   
// Second method: Build it on an ILoopbackLink with MathLink calls:
ILoopbackLink loop = MathLinkFactory.CreateLoopbackLink();
loop.PutFunction("Plus", 2);
loop.Put(2);
loop.Put(2);
Expr e2 = loop.GetExpr();
loop.Close();
result = ml.EvaluateToOutputForm(e2, 0);
e2.Dispose();
</pre> (3) Getting a string representation of an expression. Sometimes you want to be able to produce a readable string form of an entire expression, particularly for debugging. The <a href="Wolfram.NETLink.Expr.ToString.html">ToString</a> method will do this for you: <pre class="code">// This code will print out the next expression waiting on the link without
// consuming it, so that the state of the link is unchanged:
Console.WriteLine("Next expression is: " + ml.PeekExpr());
</pre> (4) Examining the structure or properties of an expression. Although it is possible to do this sort of thing with MathLink calls, it is very difficult in general. Expr lets you read an entire expression from a link and then examine it using a very high-level interface and without having to worry about managing your current position in an incoming stream of data. Expr has <i>Mathematica</i>-like methods and properties like <b>Head</b>, <b>Part</b>, <a href="Wolfram.NETLink.Expr.IntegerQ.html">IntegerQ</a>, <b>VectorQ</b>, and many others to assist in examining an expression. </p>
      <h4 class="dtH4">Requirements</h4>
      <p>
        <b>Namespace: </b>
        <a href="Wolfram.NETLink.html">Wolfram.NETLink</a>
      </p>
      <p>
        <b>Assembly: </b>Wolfram.NETLink (in Wolfram.NETLink.dll)
					</p>
      <h4 class="dtH4">See Also</h4>
      <p>
        <a href="Wolfram.NETLink.ExprMembers.html">Expr Members</a> | <a href="Wolfram.NETLink.html">Wolfram.NETLink Namespace</a></p>
      <object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e" viewastext="true" style="display: none;">
        <param name="Keyword" value="Expr class, about Expr class">
        </param>
      </object>
      <hr />
      <div id="footer">
        <p>
          <a href="http://www.wolfram.com">Copyright (c) 2003-2019, Wolfram Research, Inc.</a>
        </p>
        <p>
        </p>
      </div>
    </div>
  </body>
</html>