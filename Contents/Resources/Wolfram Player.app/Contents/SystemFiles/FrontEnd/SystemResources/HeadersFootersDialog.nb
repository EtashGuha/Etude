(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    301163,       6410]
NotebookOptionsPosition[    298677,       6343]
NotebookOutlinePosition[    301148,       6410]
CellTagsIndexPosition[    301105,       6407]
WindowFrame->ModelessDialog*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 DynamicModuleBox[{$CellContext`currentPage$$ = 
  1, $CellContext`currentPosition$$, $CellContext`opac$$ = 
  0, $CellContext`open$$ = False}, 
  TagBox[GridBox[{
     {
      ItemBox[
       PaneSelectorBox[{True->
        StyleBox[
         GraphicsBox[{
           {GrayLevel[0], Opacity[
             Dynamic[
              If[
               CurrentValue[
                EvaluationNotebook[], {PageHeaderLines, 1}], 1, 0, 0]]], 
            LineBox[{{0.5, 10}, {8, 10}}], 
            {Opacity[
              Dynamic[
               If[
                CurrentValue[
                 EvaluationNotebook[], {PageFooterLines, 1}], 1, 0, 0]]], 
             LineBox[{{0.5, 1}, {8, 1}}]}, 
            {Opacity[
              Dynamic[
               If[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaderLines, 2}], 1, 0, 0]]], 
             LineBox[{{9.5, 10}, {17, 10}}]}, 
            {Opacity[
              Dynamic[
               If[
                CurrentValue[
                 EvaluationNotebook[], {PageFooterLines, 2}], 1, 0, 0]]], 
             LineBox[{{9.5, 1}, {17, 1}}]}}, {InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 1, 1}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                1 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((1 - 1/2)/6)], 10.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 1, 2}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                1 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((2 - 1/2)/6)], 10.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 1, 3}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                1 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((3 - 1/2)/6)], 10.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 2, 1}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                2 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((1 - 1/2)/6)], 10.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 2, 2}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                2 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((2 - 1/2)/6)], 10.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 2, 3}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[
              If[2 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((3 - 1/2)/6)], 10.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageFooters, 1, 1}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                1 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((1 - 1/2)/6)], 0.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageFooters, 1, 2}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                1 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((2 - 1/2)/6)], 0.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageFooters, 1, 3}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                1 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((3 - 1/2)/6)], 0.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageFooters, 2, 1}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                2 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((1 - 1/2)/6)], 0.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageFooters, 2, 2}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                2 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((2 - 1/2)/6)], 0.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageFooters, 2, 3}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                2 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((3 - 1/2)/6)], 0.5}]}, 
           {EdgeForm[GrayLevel[0]], 
            TagBox[
             TooltipBox[
              TagBox[
               DynamicBox[Typeset`ToBoxes[
                 If[
                  CurrentValue[
                   EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  If[$CellContext`currentPage$$ == 1, {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{0, 0}, {8.5, 11}]}, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.05]], 
                    Rectangle[{0, 0}, {8.5, 11}]}, {
                    FaceForm[
                    Opacity[$CellContext`opac$$]], 
                    Rectangle[{0, 0}, {8.5, 11}]}]], {
                   FaceForm[None], 
                   Rectangle[{0, 0}, {8.5, 11}]}], StandardForm, Graphics],
                
                ImageSizeCache->{{13.13636363636364, 
                 142.92424242424244`}, {-86.83333333333337, 
                 80.83333333333331}}],
               EventHandlerTag[{"MouseClicked" :> If[
                   CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, 
                    "FacingPages"}], $CellContext`currentPage$$ = 1], Method -> 
                 "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
                 True}]],
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectPageTooltip"], StandardForm]],
              BaseStyle->"SelectionHighlight"],
             Annotation[#, 
              Dynamic[
               FEPrivate`FrontEndResource[
               "HeadersFootersDialog", "SelectPageTooltip"]], "Tooltip"]& ], 
            {EdgeForm[None], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 1, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{0., 0}, {2.833333333333333, 1}]}, {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{0., 0}, {2.833333333333333, 1}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{0., 0}, {
                    2.833333333333333, 1}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{0., 0}, {2.833333333333333, 1}]}]], 
                  StandardForm, Graphics],
                 
                 ImageSizeCache->{{13.63636363636364, 56.56565656565656}, {
                  65.18181818181816, 80.33333333333331}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    1; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Footer"] = 1; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Footer"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 1, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{0., 10}, {2.833333333333333, 11}]}, {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{0., 10}, {2.833333333333333, 11}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{0., 10}, {
                    2.833333333333333, 11}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{0., 10}, {2.833333333333333, 11}]}]], 
                  StandardForm, Graphics],
                 
                 ImageSizeCache->{{13.63636363636364, 
                  56.56565656565656}, {-86.33333333333337, \
-71.18181818181822}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    1; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Header"] = 1; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Header"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 1, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    
                    Rectangle[{2.833333333333333, 0}, {
                    5.666666666666666, 1}]}, {
                    FaceForm[
                    Opacity[0]], 
                    
                    Rectangle[{2.833333333333333, 0}, {
                    5.666666666666666, 1}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    Rectangle[{2.833333333333333, 0}, {
                    5.666666666666666, 1}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    
                    Rectangle[{2.833333333333333, 0}, {
                    5.666666666666666, 1}]}]], StandardForm, Graphics],
                 
                 ImageSizeCache->{{56.56565656565656, 99.49494949494948}, {
                  65.18181818181816, 80.33333333333331}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    1; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Footer"] = 2; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Footer"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 1, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    
                    Rectangle[{2.833333333333333, 10}, {
                    5.666666666666666, 11}]}, {
                    FaceForm[
                    Opacity[0]], 
                    
                    Rectangle[{2.833333333333333, 10}, {
                    5.666666666666666, 11}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{2.833333333333333, 10}, {
                    5.666666666666666, 11}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    
                    Rectangle[{2.833333333333333, 10}, {
                    5.666666666666666, 11}]}]], StandardForm, Graphics],
                 
                 ImageSizeCache->{{56.56565656565656, 
                  99.49494949494948}, {-86.33333333333337, \
-71.18181818181822}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    1; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Header"] = 2; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Header"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 1, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{5.666666666666666, 0}, {8.5, 1}]}, {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{5.666666666666666, 0}, {8.5, 1}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{5.666666666666666, 0}, {
                    8.5, 1}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{5.666666666666666, 0}, {8.5, 1}]}]], 
                  StandardForm, Graphics],
                 
                 ImageSizeCache->{{99.49494949494948, 142.42424242424244`}, {
                  65.18181818181816, 80.33333333333331}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    1; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Footer"] = 3; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Footer"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 1, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{5.666666666666666, 10}, {8.5, 11}]}, {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{5.666666666666666, 10}, {8.5, 11}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{5.666666666666666, 10}, {
                    8.5, 11}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{5.666666666666666, 10}, {8.5, 11}]}]], 
                  StandardForm, Graphics],
                 
                 ImageSizeCache->{{99.49494949494948, 
                  142.42424242424244`}, {-86.33333333333337, \
-71.18181818181822}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    1; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Header"] = 3; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Header"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ]}}, 
           {EdgeForm[GrayLevel[0]], 
            TagBox[
             TooltipBox[
              TagBox[
               DynamicBox[Typeset`ToBoxes[
                 If[
                  CurrentValue[
                   EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  If[$CellContext`currentPage$$ == 2, {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{9, 0}, {17.5, 11}]}, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.05]], 
                    Rectangle[{9, 0}, {17.5, 11}]}, {
                    FaceForm[
                    Opacity[$CellContext`opac$$]], 
                    Rectangle[{9, 0}, {17.5, 11}]}]], {
                   FaceForm[None], 
                   Rectangle[{9, 0}, {17.5, 11}]}], StandardForm, Graphics],
                
                ImageSizeCache->{{149.5, 
                 279.28787878787875`}, {-86.83333333333337, 
                 80.83333333333331}}],
               EventHandlerTag[{"MouseClicked" :> If[
                   CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, 
                    "FacingPages"}], $CellContext`currentPage$$ = 2], Method -> 
                 "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
                 True}]],
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectPageTooltip"], StandardForm]],
              BaseStyle->"SelectionHighlight"],
             Annotation[#, 
              Dynamic[
               FEPrivate`FrontEndResource[
               "HeadersFootersDialog", "SelectPageTooltip"]], "Tooltip"]& ], 
            {EdgeForm[None], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 2, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{9., 0}, {11.833333333333332`, 1}]}, {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{9., 0}, {11.833333333333332`, 1}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{9., 0}, {
                    11.833333333333332`, 1}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{9., 0}, {11.833333333333332`, 1}]}]], 
                  StandardForm, Graphics],
                 
                 ImageSizeCache->{{150., 192.9292929292929}, {
                  65.18181818181816, 80.33333333333331}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    2; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Footer"] = 1; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Footer"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 2, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{9., 10}, {11.833333333333332`, 11}]}, {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{9., 10}, {11.833333333333332`, 11}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{9., 10}, {
                    11.833333333333332`, 11}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{9., 10}, {11.833333333333332`, 11}]}]], 
                  StandardForm, Graphics],
                 
                 ImageSizeCache->{{150., 
                  192.9292929292929}, {-86.33333333333337, \
-71.18181818181822}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    2; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Header"] = 1; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Header"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 2, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    
                    Rectangle[{11.833333333333332`, 0}, {
                    14.666666666666666`, 1}]}, {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{11.833333333333332`, 0}, {
                    14.666666666666666`, 1}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{11.833333333333332`, 0}, {
                    14.666666666666666`, 1}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    
                    Rectangle[{11.833333333333332`, 0}, {
                    14.666666666666666`, 1}]}]], StandardForm, Graphics],
                 
                 ImageSizeCache->{{192.9292929292929, 235.85858585858585`}, {
                  65.18181818181816, 80.33333333333331}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    2; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Footer"] = 2; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Footer"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 2, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{11.833333333333332`, 10}, {
                    14.666666666666666`, 11}]}, {
                    FaceForm[
                    Opacity[0]], 
                    
                    Rectangle[{11.833333333333332`, 10}, {
                    14.666666666666666`, 11}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{11.833333333333332`, 10}, {
                    14.666666666666666`, 11}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    
                    Rectangle[{11.833333333333332`, 10}, {
                    14.666666666666666`, 11}]}]], StandardForm, Graphics],
                 
                 ImageSizeCache->{{192.9292929292929, 
                  235.85858585858585`}, {-86.33333333333337, \
-71.18181818181822}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    2; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Header"] = 2; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Header"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 2, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{14.666666666666666`, 0}, {17.5, 1}]}, {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{14.666666666666666`, 0}, {17.5, 1}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{14.666666666666666`, 0}, {
                    17.5, 1}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{14.666666666666666`, 0}, {17.5, 1}]}]], 
                  StandardForm, Graphics],
                 
                 ImageSizeCache->{{235.85858585858585`, 
                  278.78787878787875`}, {65.18181818181816, 
                  80.33333333333331}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    2; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Footer"] = 3; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Footer"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 2, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{14.666666666666666`, 10}, {17.5, 11}]}, {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{14.666666666666666`, 10}, {17.5, 11}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{14.666666666666666`, 10}, {
                    17.5, 11}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{14.666666666666666`, 10}, {17.5, 11}]}]], 
                  StandardForm, Graphics],
                 
                 ImageSizeCache->{{235.85858585858585`, 
                  278.78787878787875`}, {-86.33333333333337, \
-71.18181818181822}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    2; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Header"] = 3; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Header"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ]}}, 
           {FaceForm[Opacity[0.2]], 
            DynamicBox[Typeset`ToBoxes[
              ({
               EdgeForm[
                Opacity[
                 If[CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] === 
                  If[Part[#, 2] == 0, "Footer", "Header"], 1, 0], Red]], 
               Button[
                Interpretation[
                 Rectangle[#, # + {8.5/3, 1}], #2], Null]}& )[{If[
                  CurrentValue[
                   EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  If[$CellContext`currentPage$$ == 1, 0, 9], 
                  4.5] + ($CellContext`currentPosition$$[
                    If[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, 
                    "FacingPages"}], $CellContext`currentPage$$, 2], 
                    "Header"] - 1) (8.5/3), 
                If["Header" === "Footer", 0, 10]}, {
                Symbol[
                 StringJoin["Page", "Header", "s"]], 
                If[
                 CurrentValue[
                  EvaluationNotebook[], {
                  PrintingOptions, 
                   "FacingPages"}], $CellContext`currentPage$$, 2], 
                $CellContext`currentPosition$$[
                 If[
                  CurrentValue[
                   EvaluationNotebook[], {
                   PrintingOptions, 
                    "FacingPages"}], $CellContext`currentPage$$, 2], 
                 "Header"]}], StandardForm, Graphics],
             
             ImageSizeCache->{{13.13636363636364, 
              57.06565656565656}, {-86.83333333333337, -70.68181818181822}}], 
            DynamicBox[Typeset`ToBoxes[
              ({
               EdgeForm[
                Opacity[
                 If[CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] === 
                  If[Part[#, 2] == 0, "Footer", "Header"], 1, 0], Red]], 
               Button[
                Interpretation[
                 Rectangle[#, # + {8.5/3, 1}], #2], Null]}& )[{If[
                  CurrentValue[
                   EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  If[$CellContext`currentPage$$ == 1, 0, 9], 
                  4.5] + ($CellContext`currentPosition$$[
                    If[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, 
                    "FacingPages"}], $CellContext`currentPage$$, 2], 
                    "Footer"] - 1) (8.5/3), 
                If["Footer" === "Footer", 0, 10]}, {
                Symbol[
                 StringJoin["Page", "Footer", "s"]], 
                If[
                 CurrentValue[
                  EvaluationNotebook[], {
                  PrintingOptions, 
                   "FacingPages"}], $CellContext`currentPage$$, 2], 
                $CellContext`currentPosition$$[
                 If[
                  CurrentValue[
                   EvaluationNotebook[], {
                   PrintingOptions, 
                    "FacingPages"}], $CellContext`currentPage$$, 2], 
                 "Footer"]}], StandardForm, Graphics],
             
             ImageSizeCache->{{13.13636363636364, 57.06565656565656}, {
              64.68181818181816, 80.83333333333331}}]}},
          ImagePadding->0,
          ImageSize->{300, 200},
          PlotRange->{{-0.1, 18.1}, {-1.1, 12.1}}],
         Deployed->False,
         StripOnInput->False,
         CacheGraphics->False], False->
        StyleBox[
         GraphicsBox[{
           {GrayLevel[0], Opacity[
             Dynamic[
              If[
               CurrentValue[
                EvaluationNotebook[], {PageHeaderLines, 2}], 1, 0, 0]]], 
            LineBox[{{5, 10}, {12.5, 10}}], 
            {Opacity[
              Dynamic[
               If[
                CurrentValue[
                 EvaluationNotebook[], {PageFooterLines, 2}], 1, 0, 0]]], 
             LineBox[{{5, 1}, {12.5, 1}}]}}, {InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 1, 1}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                1 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((1 - 1/2)/6)], 10.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 1, 2}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                1 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((2 - 1/2)/6)], 10.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 1, 3}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                1 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((3 - 1/2)/6)], 10.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 2, 1}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                2 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((1 - 1/2)/6)], 10.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 2, 2}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                2 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((2 - 1/2)/6)], 10.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 2, 3}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                2 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((3 - 1/2)/6)], 10.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageFooters, 1, 1}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                1 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((1 - 1/2)/6)], 0.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageFooters, 1, 2}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                1 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((2 - 1/2)/6)], 0.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageFooters, 1, 3}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                1 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((3 - 1/2)/6)], 0.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageFooters, 2, 1}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                2 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((1 - 1/2)/6)], 0.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageFooters, 2, 2}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                2 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((2 - 1/2)/6)], 0.5}], InsetBox[
             DynamicBox[ToBoxes[
               (Replace[#, Except[""] -> "xxxx"]& )[
                CurrentValue[
                 EvaluationNotebook[], {PageFooters, 2, 3}]], TraditionalForm],
              ImageSizeCache->{20., {0., 5.}}], {
             Dynamic[If[
                2 == 1, If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  0, -8.5], If[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 9, 
                  4.5]] + 17 ((3 - 1/2)/6)], 0.5}]}, 
           {EdgeForm[GrayLevel[0]], 
            TagBox[
             TooltipBox[
              TagBox[
               DynamicBox[Typeset`ToBoxes[
                 If[
                  CurrentValue[
                   EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  If[$CellContext`currentPage$$ == 2, {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{4.5, 0}, {13., 11}]}, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.05]], 
                    Rectangle[{4.5, 0}, {13., 11}]}, {
                    FaceForm[
                    Opacity[$CellContext`opac$$]], 
                    Rectangle[{4.5, 0}, {13., 11}]}]], {
                   FaceForm[None], 
                   Rectangle[{4.5, 0}, {13., 11}]}], StandardForm, Graphics],
                
                ImageSizeCache->{{81.31818181818181, 
                 211.10606060606062`}, {-86.83333333333337, 
                 80.83333333333331}}],
               EventHandlerTag[{"MouseClicked" :> If[
                   CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, 
                    "FacingPages"}], $CellContext`currentPage$$ = 2], Method -> 
                 "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
                 True}]],
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectPageTooltip"], StandardForm]],
              BaseStyle->"SelectionHighlight"],
             Annotation[#, 
              Dynamic[
               FEPrivate`FrontEndResource[
               "HeadersFootersDialog", "SelectPageTooltip"]], "Tooltip"]& ], 
            {EdgeForm[None], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 2, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{4.5, 0}, {7.333333333333333, 1}]}, {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{4.5, 0}, {7.333333333333333, 1}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{4.5, 0}, {
                    7.333333333333333, 1}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{4.5, 0}, {7.333333333333333, 1}]}]], 
                  StandardForm, Graphics],
                 
                 ImageSizeCache->{{81.81818181818181, 124.74747474747474`}, {
                  65.18181818181816, 80.33333333333331}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    2; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Footer"] = 1; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Footer"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 2, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{4.5, 10}, {7.333333333333333, 11}]}, {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{4.5, 10}, {7.333333333333333, 11}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{4.5, 10}, {
                    7.333333333333333, 11}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{4.5, 10}, {7.333333333333333, 11}]}]], 
                  StandardForm, Graphics],
                 
                 ImageSizeCache->{{81.81818181818181, 
                  124.74747474747474`}, {-86.33333333333337, \
-71.18181818181822}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    2; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Header"] = 1; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Header"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 2, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    
                    Rectangle[{7.333333333333333, 0}, {
                    10.166666666666666`, 1}]}, {
                    FaceForm[
                    Opacity[0]], 
                    
                    Rectangle[{7.333333333333333, 0}, {
                    10.166666666666666`, 1}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{7.333333333333333, 0}, {
                    10.166666666666666`, 1}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    
                    Rectangle[{7.333333333333333, 0}, {
                    10.166666666666666`, 1}]}]], StandardForm, Graphics],
                 
                 ImageSizeCache->{{124.74747474747474`, 
                  167.67676767676767`}, {65.18181818181816, 
                  80.33333333333331}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    2; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Footer"] = 2; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Footer"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 2, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    
                    Rectangle[{7.333333333333333, 10}, {
                    10.166666666666666`, 11}]}, {
                    FaceForm[
                    Opacity[0]], 
                    
                    Rectangle[{7.333333333333333, 10}, {
                    10.166666666666666`, 11}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{7.333333333333333, 10}, {
                    10.166666666666666`, 11}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    
                    Rectangle[{7.333333333333333, 10}, {
                    10.166666666666666`, 11}]}]], StandardForm, Graphics],
                 
                 ImageSizeCache->{{124.74747474747474`, 
                  167.67676767676767`}, {-86.33333333333337, \
-71.18181818181822}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    2; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Header"] = 2; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Header"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 2, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{10.166666666666666`, 0}, {13., 1}]}, {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{10.166666666666666`, 0}, {13., 1}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{10.166666666666666`, 0}, {
                    13., 1}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{10.166666666666666`, 0}, {13., 1}]}]], 
                  StandardForm, Graphics],
                 
                 ImageSizeCache->{{167.67676767676767`, 
                  210.60606060606062`}, {65.18181818181816, 
                  80.33333333333331}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    2; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Footer"] = 3; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Footer"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ], 
             TagBox[
              TooltipBox[
               TagBox[
                DynamicBox[Typeset`ToBoxes[
                  If[$CellContext`currentPage$$ == 2, 
                   If[
                    CurrentValue["MouseOver"], {
                    FaceForm[
                    Opacity[0.1]], 
                    Rectangle[{10.166666666666666`, 10}, {13., 11}]}, {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{10.166666666666666`, 10}, {13., 11}]}], 
                   If[
                    CurrentValue["MouseOver"], $CellContext`opac$$ = 0.05; {
                    FaceForm[
                    Opacity[0.05]], 
                    
                    Rectangle[{10.166666666666666`, 10}, {
                    13., 11}]}, $CellContext`opac$$ = 0; {
                    FaceForm[
                    Opacity[0]], 
                    Rectangle[{10.166666666666666`, 10}, {13., 11}]}]], 
                  StandardForm, Graphics],
                 
                 ImageSizeCache->{{167.67676767676767`, 
                  210.60606060606062`}, {-86.33333333333337, \
-71.18181818181822}}],
                
                EventHandlerTag[{
                 "MouseClicked" :> ($CellContext`currentPage$$ = 
                    2; $CellContext`currentPosition$$[$CellContext`\
currentPage$$, "Header"] = 3; MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{"Header"}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]), Method -> "Preemptive", 
                  PassEventsDown -> Automatic, PassEventsUp -> True}]],
               DynamicBox[
                ToBoxes[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "SelectTooltip"], StandardForm]],
               BaseStyle->"SelectionHighlight"],
              Annotation[#, 
               Dynamic[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "SelectTooltip"]], "Tooltip"]& ]}}, 
           {FaceForm[Opacity[0.2]], 
            DynamicBox[Typeset`ToBoxes[
              ({
               EdgeForm[
                Opacity[
                 If[CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] === 
                  If[Part[#, 2] == 0, "Footer", "Header"], 1, 0], Red]], 
               Button[
                Interpretation[
                 Rectangle[#, # + {8.5/3, 1}], #2], Null]}& )[{If[
                  CurrentValue[
                   EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  If[$CellContext`currentPage$$ == 1, 0, 9], 
                  4.5] + ($CellContext`currentPosition$$[
                    If[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, 
                    "FacingPages"}], $CellContext`currentPage$$, 2], 
                    "Header"] - 1) (8.5/3), 
                If["Header" === "Footer", 0, 10]}, {
                Symbol[
                 StringJoin["Page", "Header", "s"]], 
                If[
                 CurrentValue[
                  EvaluationNotebook[], {
                  PrintingOptions, 
                   "FacingPages"}], $CellContext`currentPage$$, 2], 
                $CellContext`currentPosition$$[
                 If[
                  CurrentValue[
                   EvaluationNotebook[], {
                   PrintingOptions, 
                    "FacingPages"}], $CellContext`currentPage$$, 2], 
                 "Header"]}], StandardForm, Graphics],
             
             ImageSizeCache->{{13.13636363636364, 
              57.06565656565656}, {-86.83333333333337, -70.68181818181822}}], 
            DynamicBox[Typeset`ToBoxes[
              ({
               EdgeForm[
                Opacity[
                 If[CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] === 
                  If[Part[#, 2] == 0, "Footer", "Header"], 1, 0], Red]], 
               Button[
                Interpretation[
                 Rectangle[#, # + {8.5/3, 1}], #2], Null]}& )[{If[
                  CurrentValue[
                   EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                  If[$CellContext`currentPage$$ == 1, 0, 9], 
                  4.5] + ($CellContext`currentPosition$$[
                    If[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, 
                    "FacingPages"}], $CellContext`currentPage$$, 2], 
                    "Footer"] - 1) (8.5/3), 
                If["Footer" === "Footer", 0, 10]}, {
                Symbol[
                 StringJoin["Page", "Footer", "s"]], 
                If[
                 CurrentValue[
                  EvaluationNotebook[], {
                  PrintingOptions, 
                   "FacingPages"}], $CellContext`currentPage$$, 2], 
                $CellContext`currentPosition$$[
                 If[
                  CurrentValue[
                   EvaluationNotebook[], {
                   PrintingOptions, 
                    "FacingPages"}], $CellContext`currentPage$$, 2], 
                 "Footer"]}], StandardForm, Graphics],
             
             ImageSizeCache->{{13.13636363636364, 57.06565656565656}, {
              64.68181818181816, 80.83333333333331}}]}},
          ImagePadding->0,
          ImageSize->{300, 200},
          PlotRange->{{-0.1, 18.1}, {-1.1, 12.1}}],
         Deployed->False,
         StripOnInput->False,
         CacheGraphics->False]}, Dynamic[
         CurrentValue[
          EvaluationNotebook[], {PrintingOptions, "FacingPages"}]]],
       Alignment->Center,
       StripOnInput->False], "\[SpanFromLeft]"},
     {
      PaneSelectorBox[{True->
       TabViewBox[{{1,
        DynamicBox[ToBoxes[
          FEPrivate`FrontEndResource["HeadersFootersDialog", "LeftPageLabel"],
           StandardForm],
         ImageSizeCache->{49., {3., 9.}}]->
        TagBox[GridBox[{
           {
            DynamicBox[ToBoxes[
              FEPrivate`FrontEndResource[
              "HeadersFootersDialog", "HeaderLabel"], StandardForm],
             ImageSizeCache->{38., {0., 9.}}], 
            InterpretationBox[
             StyleBox[GridBox[{
                {
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Header"], {Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {1}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabel"], StandardForm],
                   ImageSizeCache->{20., {0., 9.}}]], 
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Header"], {Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {2}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "CenterLabel"], StandardForm],
                   ImageSizeCache->{35., {0., 9.}}]], 
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Header"], {Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {3}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabel"], StandardForm],
                   ImageSizeCache->{28., {3., 9.}}]]}
               },
               BaselinePosition->{1, 1},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}}],
              Deployed->True],
             SetterBar[
              Dynamic[
               $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                "Header"], {Automatic, MathLink`CallFrontEnd[
                 FrontEnd`BoxReferenceFind[
                  FE`BoxReference[
                   EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                   "StartFromBeginning"]]]& }], {1 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "LeftLabel"]], 2 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "CenterLabel"]], 3 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "RightLabel"]]}]], 
            RowBox[{
             CheckboxBox[Dynamic[
               CurrentValue[
                EvaluationNotebook[], {
                PageHeaderLines, $CellContext`currentPage$$}]]], 
             "\[InvisibleSpace]", 
             TogglerBox[Dynamic[
               CurrentValue[
                EvaluationNotebook[], {
                PageHeaderLines, $CellContext`currentPage$$}]], {True->
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageLineText"], StandardForm],
               ImageSizeCache->{61., {1., 9.}}], False->
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageLineText"], StandardForm],
               ImageSizeCache->{61., {1., 9.}}]}, 
              DynamicBox[ToBoxes[
                CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaderLines, $CellContext`currentPage$$}], StandardForm],
               ImageSizeCache->{26., {0., 9.}}]]}]},
           {"\[SpanFromAbove]", 
            RowBox[{
             InputFieldBox[Dynamic[
               ReplaceAll[
                CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}], {Pattern[$CellContext`cell$, 
                   Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                   TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                   Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1], 
                 Pattern[$CellContext`cell$, 
                   CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                   TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                   
                   EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{
                    System`FEDump`$PageCounterType = $CellContext`page$, 
                    System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                   Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                    Editable -> False, Selectable -> False], 
                 Pattern[$CellContext`cell$, 
                   StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                   TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                   
                   EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                   Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                    Editable -> False, Selectable -> False]}], (CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}] = ReplaceAll[#, TagBox[
                   Pattern[$CellContext`cell, 
                    Blank[]], 
                   Blank[EventHandlerTag], 
                   BlankSequence[]] :> Part[$CellContext`cell, 1, 1, 2]])& ], 
              Boxes,
              BoxID -> "Header",
              BaseStyle->{"Header", "TextStyleInputField"},
              ContinuousAction->True,
              FieldSize->{30, {1, 
                 DirectedInfinity[1]}}], "\[InvisibleSpace]", 
             ActionMenuBox["\<\"\[FilledRightTriangle]\"\>", {
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "FileNameLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ValueBox["FileName"]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageHeaders, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Header"]}], 
                  ValueBox["FileName"]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "DateFormatLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   
                   CurrentValue[$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "DateFormat"}], 
                   Pattern[$CellContext`cell$, 
                    StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageHeaders, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Header"]}], 
                  ReplaceAll[
                   
                   CurrentValue[$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "DateFormat"}], 
                   Pattern[$CellContext`cell$, 
                    StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageNumberLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   CounterBox[
                   "Page", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageHeaders, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Header"]}], 
                  ReplaceAll[
                   CounterBox[
                   "Page", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageTotalLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   CounterBox[
                   "LastPage", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageHeaders, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Header"]}], 
                  ReplaceAll[
                   CounterBox[
                   "LastPage", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], Delimiter, 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "RunningTextPopup"], StandardForm]]:>
              If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   Cell[
                    BoxData[
                    FormBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`RunningText["Text", 5, "", " .,", {}, True, 0], 
                    StandardForm]], TextForm]]], Pattern[$CellContext`cell$, 
                    Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                    TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                    Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageHeaders, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Header"]}], 
                  ReplaceAll[
                   Cell[
                    BoxData[
                    FormBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`RunningText["Text", 5, "", " .,", {}, True, 0], 
                    StandardForm]], TextForm]]], Pattern[$CellContext`cell$, 
                    Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                    TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                    Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1]]}]], 
              Delimiter, 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "DefaultLabel"], StandardForm]]:>
              Module[{$CellContext`nb$ = 
                CreateWindow[Visible -> False, WindowTitle -> None]}, 
               CurrentValue[
                  EvaluationNotebook[], {
                  PageHeaders, $CellContext`currentPage$$, 
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Header"]}] = FE`headersFootersDialog[False][
                  Replace[
                   ReplacePart[
                    Unevaluated[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PageHeaders, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Header"]}]], 1 -> $CellContext`nb$], None -> ""]]; 
               NotebookClose[$CellContext`nb$]]},
              Appearance->None,
              ImageMargins->{{5, 0}, {0, 0}}]}], "\[SpanFromLeft]"},
           {
            DynamicBox[ToBoxes[
              FEPrivate`FrontEndResource[
              "HeadersFootersDialog", "FooterLabel"], StandardForm],
             ImageSizeCache->{34., {0., 9.}}], 
            InterpretationBox[
             StyleBox[GridBox[{
                {
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Footer"], {Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {1}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabel"], StandardForm],
                   ImageSizeCache->{20., {0., 9.}}]], 
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Footer"], {Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {2}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "CenterLabel"], StandardForm],
                   ImageSizeCache->{35., {0., 9.}}]], 
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Footer"], {Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {3}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabel"], StandardForm],
                   ImageSizeCache->{28., {3., 9.}}]]}
               },
               BaselinePosition->{1, 1},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}}],
              Deployed->True],
             SetterBar[
              Dynamic[
               $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                "Footer"], {Automatic, MathLink`CallFrontEnd[
                 FrontEnd`BoxReferenceFind[
                  FE`BoxReference[
                   EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                   "StartFromBeginning"]]]& }], {1 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "LeftLabel"]], 2 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "CenterLabel"]], 3 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "RightLabel"]]}]], 
            RowBox[{
             CheckboxBox[Dynamic[
               CurrentValue[
                EvaluationNotebook[], {
                PageFooterLines, $CellContext`currentPage$$}]]], 
             "\[InvisibleSpace]", 
             TogglerBox[Dynamic[
               CurrentValue[
                EvaluationNotebook[], {
                PageFooterLines, $CellContext`currentPage$$}]], {True->
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageLineText"], StandardForm],
               ImageSizeCache->{61., {1., 9.}}], False->
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageLineText"], StandardForm],
               ImageSizeCache->{61., {1., 9.}}]}, 
              DynamicBox[ToBoxes[
                CurrentValue[
                 EvaluationNotebook[], {
                 PageFooterLines, $CellContext`currentPage$$}], StandardForm],
               ImageSizeCache->{26., {0., 9.}}]]}]},
           {"\[SpanFromAbove]", 
            RowBox[{
             InputFieldBox[Dynamic[
               ReplaceAll[
                CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}], {Pattern[$CellContext`cell$, 
                   Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                   TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                   Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1], 
                 Pattern[$CellContext`cell$, 
                   CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                   TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                   
                   EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                   Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                    Editable -> False, Selectable -> False], 
                 Pattern[$CellContext`cell$, 
                   StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                   TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                   
                   EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                   Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                    Editable -> False, Selectable -> False]}], (CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}] = ReplaceAll[#, TagBox[
                   Pattern[$CellContext`cell, 
                    Blank[]], 
                   Blank[EventHandlerTag], 
                   BlankSequence[]] :> Part[$CellContext`cell, 1, 1, 2]])& ], 
              Boxes,
              BoxID -> "Footer",
              BaseStyle->{"Footer", "TextStyleInputField"},
              ContinuousAction->True,
              FieldSize->{30, {1, 
                 DirectedInfinity[1]}}], "\[InvisibleSpace]", 
             ActionMenuBox["\<\"\[FilledRightTriangle]\"\>", {
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "FileNameLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ValueBox["FileName"]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageFooters, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Footer"]}], 
                  ValueBox["FileName"]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "DateFormatLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   
                   CurrentValue[$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "DateFormat"}], 
                   Pattern[$CellContext`cell$, 
                    StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageFooters, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Footer"]}], 
                  ReplaceAll[
                   
                   CurrentValue[$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "DateFormat"}], 
                   Pattern[$CellContext`cell$, 
                    StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageNumberLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   CounterBox[
                   "Page", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageFooters, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Footer"]}], 
                  ReplaceAll[
                   CounterBox[
                   "Page", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageTotalLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   CounterBox[
                   "LastPage", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageFooters, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Footer"]}], 
                  ReplaceAll[
                   CounterBox[
                   "LastPage", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], Delimiter, 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "RunningTextPopup"], StandardForm]]:>
              If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   Cell[
                    BoxData[
                    FormBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`RunningText["Text", 5, "", " .,", {}, True, 0], 
                    StandardForm]], TextForm]]], Pattern[$CellContext`cell$, 
                    Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                    TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                    Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageFooters, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Footer"]}], 
                  ReplaceAll[
                   Cell[
                    BoxData[
                    FormBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`RunningText["Text", 5, "", " .,", {}, True, 0], 
                    StandardForm]], TextForm]]], Pattern[$CellContext`cell$, 
                    Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                    TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                    Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1]]}]], 
              Delimiter, 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "DefaultLabel"], StandardForm]]:>
              Module[{$CellContext`nb$ = 
                CreateWindow[Visible -> False, WindowTitle -> None]}, 
               CurrentValue[
                  EvaluationNotebook[], {
                  PageFooters, $CellContext`currentPage$$, 
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Footer"]}] = FE`headersFootersDialog[False][
                  Replace[
                   ReplacePart[
                    Unevaluated[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PageFooters, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Footer"]}]], 1 -> $CellContext`nb$], None -> ""]]; 
               NotebookClose[$CellContext`nb$]]},
              Appearance->None,
              ImageMargins->{{5, 0}, {0, 0}}]}], "\[SpanFromLeft]"}
          },
          AutoDelete->False,
          GridBoxAlignment->{"Columns" -> {{Left}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{1}}, "Rows" -> {0, 0.5, 2, 0.5}}],
         "Grid"]}, {2,
        DynamicBox[ToBoxes[
          FEPrivate`FrontEndResource[
          "HeadersFootersDialog", "RightPageLabel"], StandardForm],
         ImageSizeCache->{57., {3., 9.}}]->
        TagBox[GridBox[{
           {
            DynamicBox[ToBoxes[
              FEPrivate`FrontEndResource[
              "HeadersFootersDialog", "HeaderLabel"], StandardForm],
             ImageSizeCache->{38., {0., 9.}}], 
            InterpretationBox[
             StyleBox[GridBox[{
                {
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Header"], {Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {1}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabel"], StandardForm],
                   ImageSizeCache->{20., {0., 9.}}]], 
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Header"], {Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {2}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "CenterLabel"], StandardForm],
                   ImageSizeCache->{35., {0., 9.}}]], 
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Header"], {Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {3}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabel"], StandardForm],
                   ImageSizeCache->{28., {3., 9.}}]]}
               },
               BaselinePosition->{1, 1},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}}],
              Deployed->True],
             SetterBar[
              Dynamic[
               $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                "Header"], {Automatic, MathLink`CallFrontEnd[
                 FrontEnd`BoxReferenceFind[
                  FE`BoxReference[
                   EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                   "StartFromBeginning"]]]& }], {1 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "LeftLabel"]], 2 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "CenterLabel"]], 3 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "RightLabel"]]}]], 
            RowBox[{
             CheckboxBox[Dynamic[
               CurrentValue[
                EvaluationNotebook[], {
                PageHeaderLines, $CellContext`currentPage$$}]]], 
             "\[InvisibleSpace]", 
             TogglerBox[Dynamic[
               CurrentValue[
                EvaluationNotebook[], {
                PageHeaderLines, $CellContext`currentPage$$}]], {True->
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageLineText"], StandardForm],
               ImageSizeCache->{61., {1., 9.}}], False->
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageLineText"], StandardForm],
               ImageSizeCache->{61., {1., 9.}}]}, 
              DynamicBox[ToBoxes[
                CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaderLines, $CellContext`currentPage$$}], StandardForm],
               ImageSizeCache->{26., {0., 9.}}]]}]},
           {"\[SpanFromAbove]", 
            RowBox[{
             InputFieldBox[Dynamic[
               ReplaceAll[
                CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}], {Pattern[$CellContext`cell$, 
                   Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                   TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                   Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1], 
                 Pattern[$CellContext`cell$, 
                   CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                   TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                   
                   EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                   Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                    Editable -> False, Selectable -> False], 
                 Pattern[$CellContext`cell$, 
                   StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                   TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                   
                   EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                   Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                    Editable -> False, Selectable -> False]}], (CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}] = ReplaceAll[#, TagBox[
                   Pattern[$CellContext`cell, 
                    Blank[]], 
                   Blank[EventHandlerTag], 
                   BlankSequence[]] :> Part[$CellContext`cell, 1, 1, 2]])& ], 
              Boxes,
              BoxID -> "Header",
              BaseStyle->{"Header", "TextStyleInputField"},
              ContinuousAction->True,
              FieldSize->{30, {1, 
                 DirectedInfinity[1]}}], "\[InvisibleSpace]", 
             ActionMenuBox["\<\"\[FilledRightTriangle]\"\>", {
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "FileNameLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ValueBox["FileName"]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageHeaders, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Header"]}], 
                  ValueBox["FileName"]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "DateFormatLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   
                   CurrentValue[$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "DateFormat"}], 
                   Pattern[$CellContext`cell$, 
                    StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageHeaders, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Header"]}], 
                  ReplaceAll[
                   
                   CurrentValue[$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "DateFormat"}], 
                   Pattern[$CellContext`cell$, 
                    StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageNumberLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   CounterBox[
                   "Page", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageHeaders, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Header"]}], 
                  ReplaceAll[
                   CounterBox[
                   "Page", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageTotalLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   CounterBox[
                   "LastPage", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageHeaders, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Header"]}], 
                  ReplaceAll[
                   CounterBox[
                   "LastPage", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], Delimiter, 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "RunningTextPopup"], StandardForm]]:>
              If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   Cell[
                    BoxData[
                    FormBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`RunningText["Text", 5, "", " .,", {}, True, 0], 
                    StandardForm]], TextForm]]], Pattern[$CellContext`cell$, 
                    Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                    TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                    Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageHeaders, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageHeaders, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Header"]}], 
                  ReplaceAll[
                   Cell[
                    BoxData[
                    FormBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`RunningText["Text", 5, "", " .,", {}, True, 0], 
                    StandardForm]], TextForm]]], Pattern[$CellContext`cell$, 
                    Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                    TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                    Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1]]}]], 
              Delimiter, 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "DefaultLabel"], StandardForm]]:>
              Module[{$CellContext`nb$ = 
                CreateWindow[Visible -> False, WindowTitle -> None]}, 
               CurrentValue[
                  EvaluationNotebook[], {
                  PageHeaders, $CellContext`currentPage$$, 
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Header"]}] = FE`headersFootersDialog[False][
                  Replace[
                   ReplacePart[
                    Unevaluated[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PageHeaders, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Header"]}]], 1 -> $CellContext`nb$], None -> ""]]; 
               NotebookClose[$CellContext`nb$]]},
              Appearance->None,
              ImageMargins->{{5, 0}, {0, 0}}]}], "\[SpanFromLeft]"},
           {
            DynamicBox[ToBoxes[
              FEPrivate`FrontEndResource[
              "HeadersFootersDialog", "FooterLabel"], StandardForm],
             ImageSizeCache->{34., {0., 9.}}], 
            InterpretationBox[
             StyleBox[GridBox[{
                {
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Footer"], {Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {1}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabel"], StandardForm],
                   ImageSizeCache->{20., {0., 9.}}]], 
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Footer"], {Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {2}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "CenterLabel"], StandardForm],
                   ImageSizeCache->{35., {0., 9.}}]], 
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Footer"], {Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {3}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabel"], StandardForm],
                   ImageSizeCache->{28., {3., 9.}}]]}
               },
               BaselinePosition->{1, 1},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}}],
              Deployed->True],
             SetterBar[
              Dynamic[
               $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                "Footer"], {Automatic, MathLink`CallFrontEnd[
                 FrontEnd`BoxReferenceFind[
                  FE`BoxReference[
                   EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                   "StartFromBeginning"]]]& }], {1 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "LeftLabel"]], 2 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "CenterLabel"]], 3 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "RightLabel"]]}]], 
            RowBox[{
             CheckboxBox[Dynamic[
               CurrentValue[
                EvaluationNotebook[], {
                PageFooterLines, $CellContext`currentPage$$}]]], 
             "\[InvisibleSpace]", 
             TogglerBox[Dynamic[
               CurrentValue[
                EvaluationNotebook[], {
                PageFooterLines, $CellContext`currentPage$$}]], {True->
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageLineText"], StandardForm],
               ImageSizeCache->{61., {1., 9.}}], False->
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageLineText"], StandardForm],
               ImageSizeCache->{61., {1., 9.}}]}, 
              DynamicBox[ToBoxes[
                CurrentValue[
                 EvaluationNotebook[], {
                 PageFooterLines, $CellContext`currentPage$$}], StandardForm],
               ImageSizeCache->{26., {0., 9.}}]]}]},
           {"\[SpanFromAbove]", 
            RowBox[{
             InputFieldBox[Dynamic[
               ReplaceAll[
                CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}], {Pattern[$CellContext`cell$, 
                   Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                   TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                   Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1], 
                 Pattern[$CellContext`cell$, 
                   CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                   TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                   
                   EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                   Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                    Editable -> False, Selectable -> False], 
                 Pattern[$CellContext`cell$, 
                   StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                   TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                   
                   EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                   Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                    Editable -> False, Selectable -> False]}], (CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}] = ReplaceAll[#, TagBox[
                   Pattern[$CellContext`cell, 
                    Blank[]], 
                   Blank[EventHandlerTag], 
                   BlankSequence[]] :> Part[$CellContext`cell, 1, 1, 2]])& ], 
              Boxes,
              BoxID -> "Footer",
              BaseStyle->{"Footer", "TextStyleInputField"},
              ContinuousAction->True,
              FieldSize->{30, {1, 
                 DirectedInfinity[1]}}], "\[InvisibleSpace]", 
             ActionMenuBox["\<\"\[FilledRightTriangle]\"\>", {
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "FileNameLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ValueBox["FileName"]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageFooters, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Footer"]}], 
                  ValueBox["FileName"]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "DateFormatLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   
                   CurrentValue[$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "DateFormat"}], 
                   Pattern[$CellContext`cell$, 
                    StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageFooters, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Footer"]}], 
                  ReplaceAll[
                   
                   CurrentValue[$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "DateFormat"}], 
                   Pattern[$CellContext`cell$, 
                    StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageNumberLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   CounterBox[
                   "Page", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageFooters, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Footer"]}], 
                  ReplaceAll[
                   CounterBox[
                   "Page", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageTotalLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   CounterBox[
                   "LastPage", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageFooters, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Footer"]}], 
                  ReplaceAll[
                   CounterBox[
                   "LastPage", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], Delimiter, 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "RunningTextPopup"], StandardForm]]:>
              If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   Cell[
                    BoxData[
                    FormBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`RunningText["Text", 5, "", " .,", {}, True, 0], 
                    StandardForm]], TextForm]]], Pattern[$CellContext`cell$, 
                    Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                    TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                    Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {
                 PageFooters, $CellContext`currentPage$$, 
                  $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                   "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {
                   PageFooters, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Footer"]}], 
                  ReplaceAll[
                   Cell[
                    BoxData[
                    FormBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`RunningText["Text", 5, "", " .,", {}, True, 0], 
                    StandardForm]], TextForm]]], Pattern[$CellContext`cell$, 
                    Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                    TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                    Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1]]}]], 
              Delimiter, 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "DefaultLabel"], StandardForm]]:>
              Module[{$CellContext`nb$ = 
                CreateWindow[Visible -> False, WindowTitle -> None]}, 
               CurrentValue[
                  EvaluationNotebook[], {
                  PageFooters, $CellContext`currentPage$$, 
                   $CellContext`currentPosition$$[$CellContext`currentPage$$, 
                    "Footer"]}] = FE`headersFootersDialog[False][
                  Replace[
                   ReplacePart[
                    Unevaluated[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PageFooters, $CellContext`currentPage$$, 
                    $CellContext`currentPosition$$[$CellContext`currentPage$$,
                     "Footer"]}]], 1 -> $CellContext`nb$], None -> ""]]; 
               NotebookClose[$CellContext`nb$]]},
              Appearance->None,
              ImageMargins->{{5, 0}, {0, 0}}]}], "\[SpanFromLeft]"}
          },
          AutoDelete->False,
          GridBoxAlignment->{"Columns" -> {{Left}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{1}}, "Rows" -> {0, 0.5, 2, 0.5}}],
         "Grid"]}}, Dynamic[$CellContext`currentPage$$]], False->
       TabViewBox[{{1,
        DynamicBox[ToBoxes[
          FEPrivate`FrontEndResource[
          "HeadersFootersDialog", "SinglePageLabel"], StandardForm],
         ImageSizeCache->{61., {3., 9.}}]->
        TagBox[GridBox[{
           {
            DynamicBox[ToBoxes[
              FEPrivate`FrontEndResource[
              "HeadersFootersDialog", "HeaderLabel"], StandardForm],
             ImageSizeCache->{38., {0., 9.}}], 
            InterpretationBox[
             StyleBox[GridBox[{
                {
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[2, "Header"], {
                   Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {1}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabel"], StandardForm],
                   ImageSizeCache->{20., {0., 9.}}]], 
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[2, "Header"], {
                   Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {2}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "CenterLabel"], StandardForm],
                   ImageSizeCache->{35., {0., 9.}}]], 
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[2, "Header"], {
                   Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {3}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabel"], StandardForm],
                   ImageSizeCache->{28., {3., 9.}}]]}
               },
               BaselinePosition->{1, 1},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}}],
              Deployed->True],
             SetterBar[
              Dynamic[
               $CellContext`currentPosition$$[2, "Header"], {
               Automatic, MathLink`CallFrontEnd[
                 FrontEnd`BoxReferenceFind[
                  FE`BoxReference[
                   EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                   "StartFromBeginning"]]]& }], {1 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "LeftLabel"]], 2 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "CenterLabel"]], 3 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "RightLabel"]]}]], 
            RowBox[{
             CheckboxBox[Dynamic[
               CurrentValue[
                EvaluationNotebook[], {PageHeaderLines, 2}]]], 
             "\[InvisibleSpace]", 
             TogglerBox[Dynamic[
               CurrentValue[
                EvaluationNotebook[], {PageHeaderLines, 2}]], {True->
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageLineText"], StandardForm],
               ImageSizeCache->{61., {1., 9.}}], False->
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageLineText"], StandardForm],
               ImageSizeCache->{61., {1., 9.}}]}, 
              DynamicBox[ToBoxes[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaderLines, 2}], StandardForm],
               ImageSizeCache->{26., {0., 9.}}]]}]},
           {"\[SpanFromAbove]", 
            RowBox[{
             InputFieldBox[Dynamic[
               ReplaceAll[
                CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 2, 
                  $CellContext`currentPosition$$[2, "Header"]}], {
                Pattern[$CellContext`cell$, 
                   Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                   TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                   Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1], 
                 Pattern[$CellContext`cell$, 
                   CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                   TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                   
                   EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                   Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                    Editable -> False, Selectable -> False], 
                 Pattern[$CellContext`cell$, 
                   StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                   TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                   
                   EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                   Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                    Editable -> False, Selectable -> False]}], (CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 2, 
                  $CellContext`currentPosition$$[2, "Header"]}] = 
               ReplaceAll[#, TagBox[
                   Pattern[$CellContext`cell, 
                    Blank[]], 
                   Blank[EventHandlerTag], 
                   BlankSequence[]] :> Part[$CellContext`cell, 1, 1, 2]])& ], 
              Boxes,
              BoxID -> "Header",
              BaseStyle->{"Header", "TextStyleInputField"},
              ContinuousAction->True,
              FieldSize->{30, {1, 
                 DirectedInfinity[1]}}], "\[InvisibleSpace]", 
             ActionMenuBox["\<\"\[FilledRightTriangle]\"\>", {
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "FileNameLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ValueBox["FileName"]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 2, 
                  $CellContext`currentPosition$$[2, "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {PageHeaders, 2, 
                    $CellContext`currentPosition$$[2, "Header"]}], 
                  ValueBox["FileName"]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "DateFormatLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   
                   CurrentValue[$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "DateFormat"}], 
                   Pattern[$CellContext`cell$, 
                    StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 2, 
                  $CellContext`currentPosition$$[2, "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {PageHeaders, 2, 
                    $CellContext`currentPosition$$[2, "Header"]}], 
                  ReplaceAll[
                   
                   CurrentValue[$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "DateFormat"}], 
                   Pattern[$CellContext`cell$, 
                    StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageNumberLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   CounterBox[
                   "Page", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 2, 
                  $CellContext`currentPosition$$[2, "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {PageHeaders, 2, 
                    $CellContext`currentPosition$$[2, "Header"]}], 
                  ReplaceAll[
                   CounterBox[
                   "Page", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageTotalLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   CounterBox[
                   "LastPage", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 2, 
                  $CellContext`currentPosition$$[2, "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {PageHeaders, 2, 
                    $CellContext`currentPosition$$[2, "Header"]}], 
                  ReplaceAll[
                   CounterBox[
                   "LastPage", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], Delimiter, 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "RunningTextPopup"], StandardForm]]:>
              If[
               (And[Head[#] === FE`BoxReference, Part[#, 2, 1] === "Header"]& 
               )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   Cell[
                    BoxData[
                    FormBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`RunningText["Text", 5, "", " .,", {}, True, 0], 
                    StandardForm]], TextForm]]], Pattern[$CellContext`cell$, 
                    Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                    TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                    Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {PageHeaders, 2, 
                  $CellContext`currentPosition$$[2, "Header"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {PageHeaders, 2, 
                    $CellContext`currentPosition$$[2, "Header"]}], 
                  ReplaceAll[
                   Cell[
                    BoxData[
                    FormBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`RunningText["Text", 5, "", " .,", {}, True, 0], 
                    StandardForm]], TextForm]]], Pattern[$CellContext`cell$, 
                    Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                    TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Header"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                    Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1]]}]], 
              Delimiter, 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "DefaultLabel"], StandardForm]]:>
              Module[{$CellContext`nb$ = 
                CreateWindow[Visible -> False, WindowTitle -> None]}, 
               CurrentValue[
                  EvaluationNotebook[], {PageHeaders, 2, 
                   $CellContext`currentPosition$$[2, "Header"]}] = 
                FE`headersFootersDialog[False][
                  Replace[
                   ReplacePart[
                    Unevaluated[
                    CurrentValue[
                    EvaluationNotebook[], {PageHeaders, 2, 
                    $CellContext`currentPosition$$[2, "Header"]}]], 
                    1 -> $CellContext`nb$], None -> ""]]; 
               NotebookClose[$CellContext`nb$]]},
              Appearance->None,
              ImageMargins->{{5, 0}, {0, 0}}]}], "\[SpanFromLeft]"},
           {
            DynamicBox[ToBoxes[
              FEPrivate`FrontEndResource[
              "HeadersFootersDialog", "FooterLabel"], StandardForm],
             ImageSizeCache->{34., {0., 9.}}], 
            InterpretationBox[
             StyleBox[GridBox[{
                {
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[2, "Footer"], {
                   Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {1}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabel"], StandardForm],
                   ImageSizeCache->{20., {0., 9.}}]], 
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[2, "Footer"], {
                   Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {2}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "CenterLabel"], StandardForm],
                   ImageSizeCache->{35., {0., 9.}}]], 
                 SetterBox[Dynamic[
                   $CellContext`currentPosition$$[2, "Footer"], {
                   Automatic, MathLink`CallFrontEnd[
                    FrontEnd`BoxReferenceFind[
                    FE`BoxReference[
                    EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                    "StartFromBeginning"]]]& }], {3}, 
                  DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabel"], StandardForm],
                   ImageSizeCache->{28., {3., 9.}}]]}
               },
               BaselinePosition->{1, 1},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.]}, 
                   Offset[0.27999999999999997`]}, "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}}],
              Deployed->True],
             SetterBar[
              Dynamic[
               $CellContext`currentPosition$$[2, "Footer"], {
               Automatic, MathLink`CallFrontEnd[
                 FrontEnd`BoxReferenceFind[
                  FE`BoxReference[
                   EvaluationNotebook[], {{#}}, FE`BoxOffset -> {
                    FE`BoxChild[1]}, FE`SearchStart -> 
                   "StartFromBeginning"]]]& }], {1 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "LeftLabel"]], 2 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "CenterLabel"]], 3 -> Dynamic[
                 FEPrivate`FrontEndResource[
                 "HeadersFootersDialog", "RightLabel"]]}]], 
            RowBox[{
             CheckboxBox[Dynamic[
               CurrentValue[
                EvaluationNotebook[], {PageFooterLines, 2}]]], 
             "\[InvisibleSpace]", 
             TogglerBox[Dynamic[
               CurrentValue[
                EvaluationNotebook[], {PageFooterLines, 2}]], {True->
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageLineText"], StandardForm],
               ImageSizeCache->{61., {1., 9.}}], False->
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageLineText"], StandardForm],
               ImageSizeCache->{61., {1., 9.}}]}, 
              DynamicBox[ToBoxes[
                CurrentValue[
                 EvaluationNotebook[], {PageFooterLines, 2}], StandardForm],
               ImageSizeCache->{26., {0., 9.}}]]}]},
           {"\[SpanFromAbove]", 
            RowBox[{
             InputFieldBox[Dynamic[
               ReplaceAll[
                CurrentValue[
                 EvaluationNotebook[], {PageFooters, 2, 
                  $CellContext`currentPosition$$[2, "Footer"]}], {
                Pattern[$CellContext`cell$, 
                   Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                   TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                   Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1], 
                 Pattern[$CellContext`cell$, 
                   CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                   TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                   
                   EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                   Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                    Editable -> False, Selectable -> False], 
                 Pattern[$CellContext`cell$, 
                   StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                   TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                   
                   EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                   Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                    Editable -> False, Selectable -> False]}], (CurrentValue[
                 EvaluationNotebook[], {PageFooters, 2, 
                  $CellContext`currentPosition$$[2, "Footer"]}] = 
               ReplaceAll[#, TagBox[
                   Pattern[$CellContext`cell, 
                    Blank[]], 
                   Blank[EventHandlerTag], 
                   BlankSequence[]] :> Part[$CellContext`cell, 1, 1, 2]])& ], 
              Boxes,
              BoxID -> "Footer",
              BaseStyle->{"Footer", "TextStyleInputField"},
              ContinuousAction->True,
              FieldSize->{30, {1, 
                 DirectedInfinity[1]}}], "\[InvisibleSpace]", 
             ActionMenuBox["\<\"\[FilledRightTriangle]\"\>", {
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "FileNameLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ValueBox["FileName"]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {PageFooters, 2, 
                  $CellContext`currentPosition$$[2, "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {PageFooters, 2, 
                    $CellContext`currentPosition$$[2, "Footer"]}], 
                  ValueBox["FileName"]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "DateFormatLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   
                   CurrentValue[$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "DateFormat"}], 
                   Pattern[$CellContext`cell$, 
                    StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {PageFooters, 2, 
                  $CellContext`currentPosition$$[2, "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {PageFooters, 2, 
                    $CellContext`currentPosition$$[2, "Footer"]}], 
                  ReplaceAll[
                   
                   CurrentValue[$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "DateFormat"}], 
                   Pattern[$CellContext`cell$, 
                    StyleBox[
                    Blank[], TaggingRules -> {"Date", 
                    Pattern[$CellContext`n$, 
                    Blank[]]}]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "DateFormatCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$DateIndex = $CellContext`n$, 
                    System`FEDump`$DateFormat = First[$CellContext`cell$]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersDateFormat.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageNumberLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   CounterBox[
                   "Page", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {PageFooters, 2, 
                  $CellContext`currentPosition$$[2, "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {PageFooters, 2, 
                    $CellContext`currentPosition$$[2, "Footer"]}], 
                  ReplaceAll[
                   CounterBox[
                   "Page", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "PageTotalLabel"], StandardForm]]:>If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   CounterBox[
                   "LastPage", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {PageFooters, 2, 
                  $CellContext`currentPosition$$[2, "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {PageFooters, 2, 
                    $CellContext`currentPosition$$[2, "Footer"]}], 
                  ReplaceAll[
                   CounterBox[
                   "LastPage", CounterFunction -> 
                    CurrentValue[
                    FrontEnd`$FrontEnd, {
                    PrivateFrontEndOptions, "DialogSettings", 
                    "HeadersFooters", "PageNumberFormat"}]], 
                   Pattern[$CellContext`cell$, 
                    CounterBox[
                    Pattern[$CellContext`page$, 
                    Alternatives["Page", "LastPage"]], 
                    BlankNullSequence[]]] :> TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource["HeadersFootersDialog", 
                    FEPrivate`If[
                    FEPrivate`SameQ[$CellContext`page$, "Page"], 
                    "PageNumberCounterLabel", 
                    "PageTotalCounterLabel"]]], $CellContext`cell$]], 
                    "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$PageCounterType = \
$CellContext`page$, System`FEDump`$PageCounterFunction = Identity[
                    ReplaceAll[
                    ReplaceAll[CounterFunction, 
                    Apply[{
                    SlotSequence[2]}& , $CellContext`cell$]], CounterFunction -> 
                    Identity]]}, CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersPageNumber.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False]]}]], Delimiter, 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "RunningTextPopup"], StandardForm]]:>
              If[
               (And[
               Head[#] === FE`BoxReference, Part[#, 2, 1] === "Footer"]& )[
                MathLink`CallFrontEnd[
                 FrontEnd`GetBoxIDs[
                  EvaluationNotebook[]]]], 
               With[{$CellContext`v = ReplaceAll[
                   Cell[
                    BoxData[
                    FormBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`RunningText["Text", 5, "", " .,", {}, True, 0], 
                    StandardForm]], TextForm]]], Pattern[$CellContext`cell$, 
                    Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                    TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                    Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1]]}, 
                NotebookWrite[
                 EvaluationNotebook[], $CellContext`v, All]], CurrentValue[
                 EvaluationNotebook[], {PageFooters, 2, 
                  $CellContext`currentPosition$$[2, "Footer"]}] = RowBox[{
                  CurrentValue[
                   EvaluationNotebook[], {PageFooters, 2, 
                    $CellContext`currentPosition$$[2, "Footer"]}], 
                  ReplaceAll[
                   Cell[
                    BoxData[
                    FormBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`RunningText["Text", 5, "", " .,", {}, True, 0], 
                    StandardForm]], TextForm]]], Pattern[$CellContext`cell$, 
                    Alternatives[
                    Blank[Cell], 
                    Blank[FormBox]]] :> Condition[
                    TagBox[
                    TagBox[
                    FrameBox[
                    InterpretationBox[
                    DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RunningTextCounterLabel"], 
                    StandardForm]], $CellContext`cell$]], "Placeholder"], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> 
                    Block[{System`FEDump`$RunningTextStyles = 
                    With[{$CellContext`nb = CurrentValue[
                    ButtonNotebook[], {
                    TaggingRules, "InputNotebook"}], $CellContext`styles = 
                    Part[
                    Rest[
                    FE`Evaluate[
                    FEPrivate`GetPopupList["MenuListStyles"]]], All, 1]}, 
                    SelectionMove[$CellContext`nb, All, Notebook]; Join[
                    Replace[
                    Complement[
                    Quiet[
                    Check[
                    Union[
                    Replace["Style", 
                    
                    Developer`CellInformation[$CellContext`nb]]], {}]], \
$CellContext`styles], {
                    Pattern[$CellContext`x, 
                    BlankSequence[]]} :> {$CellContext`x, 
                    Delimiter}], $CellContext`styles]], 
                    System`FEDump`$RunningTextData = First[
                    Cases[$CellContext`cell$, FEPrivate`RunningText[
                    Pattern[$CellContext`x, 
                    BlankSequence[]]] :> {$CellContext`x}, Infinity]]}, 
                    CurrentValue[
                    EvaluationNotebook[], {TaggingRules, "Highlight"}] = 
                    "Footer"; SelectionMove[
                    EvaluationBox[], All, Expression]; 
                    FrontEnd`DialogOpen["HeadersFootersRunningText.nb", True]; 
                    Null], PassEventsDown -> True, PassEventsUp -> True}], 
                    Tooltip -> DynamicBox[
                    ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "EditorsTooltip"], StandardForm]],
                     Editable -> False, Selectable -> False], 
                    Count[$CellContext`cell$, 
                    Blank[FEPrivate`RunningText], Infinity] == 1]]}]], 
              Delimiter, 
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "HeadersFootersDialog", "DefaultLabel"], StandardForm]]:>
              Module[{$CellContext`nb$ = 
                CreateWindow[Visible -> False, WindowTitle -> None]}, 
               CurrentValue[
                  EvaluationNotebook[], {PageFooters, 2, 
                   $CellContext`currentPosition$$[2, "Footer"]}] = 
                FE`headersFootersDialog[False][
                  Replace[
                   ReplacePart[
                    Unevaluated[
                    CurrentValue[
                    EvaluationNotebook[], {PageFooters, 2, 
                    $CellContext`currentPosition$$[2, "Footer"]}]], 
                    1 -> $CellContext`nb$], None -> ""]]; 
               NotebookClose[$CellContext`nb$]]},
              Appearance->None,
              ImageMargins->{{5, 0}, {0, 0}}]}], "\[SpanFromLeft]"}
          },
          AutoDelete->False,
          GridBoxAlignment->{"Columns" -> {{Left}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{1}}, "Rows" -> {0, 0.5, 2, 0.5}}],
         "Grid"]}}, 1]}, Dynamic[
        CurrentValue[
         EvaluationNotebook[], {PrintingOptions, "FacingPages"}]]], 
      "\[SpanFromLeft]"},
     {
      InterpretationBox[
       StyleBox[
        PaneSelectorBox[{False->GridBox[{
           {
            OpenerBox[Dynamic[$CellContext`open$$],
             Appearance->Automatic,
             AutoAction->False,
             ContinuousAction->False,
             Enabled->Automatic], 
            TagBox[
             DynamicBox[ToBoxes[
               FEPrivate`FrontEndResource[
               "HeadersFootersDialog", "OptionsLabel"], StandardForm],
              ImageSizeCache->{42., {3., 9.}}],
             
             EventHandlerTag[{
              "MouseClicked" :> ($CellContext`open$$ = 
                Not[$CellContext`open$$]), Method -> "Preemptive", 
               PassEventsDown -> Automatic, PassEventsUp -> True}]]}
          },
          AutoDelete->False,
          BaselinePosition->{1, 1},
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxBackground->{"Columns" -> {{Automatic}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{0.2}}, "Rows" -> {{0.5}}}], True->
         GridBox[{
           {
            OpenerBox[Dynamic[$CellContext`open$$],
             Appearance->Automatic,
             AutoAction->False,
             ContinuousAction->False,
             Enabled->Automatic], 
            TagBox[
             DynamicBox[ToBoxes[
               FEPrivate`FrontEndResource[
               "HeadersFootersDialog", "OptionsLabel"], StandardForm]],
             
             EventHandlerTag[{
              "MouseClicked" :> ($CellContext`open$$ = 
                Not[$CellContext`open$$]), Method -> "Preemptive", 
               PassEventsDown -> Automatic, PassEventsUp -> True}]]},
           {"", 
            PaneBox[
             TagBox[GridBox[{
                {
                 DynamicBox[ToBoxes[
                   FEPrivate`FrontEndResource[
                   "HeadersFootersDialog", "StartPageLabel"], StandardForm]], 
                 InputFieldBox[Dynamic[
                   CurrentValue[
                    EvaluationNotebook[], PrintingStartingPageNumber]], Number,
                  FieldSize->{{5, 10}, 1}]},
                {
                 RowBox[{
                  RowBox[{
                   CheckboxBox[Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {PrintingOptions, "FacingPages"}]]],
                    "\[InvisibleSpace]", 
                   TogglerBox[Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FacingPages"}]], {True->
                    DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "FacingLabel"], StandardForm]], 
                    False->
                    DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "FacingLabel"], StandardForm]]}, 
                    DynamicBox[ToBoxes[
                    CurrentValue[
                    EvaluationNotebook[], {PrintingOptions, "FacingPages"}], 
                    StandardForm]]]}], "\[InvisibleSpace]", 
                  InterpretationBox[
                   StyleBox[
                    RowBox[{GridBox[{
                    {
                    RadioButtonBox[Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageFace"}]], {Left},
                    Appearance->Tiny,
                    BaselinePosition->1,
                    DefaultBaseStyle->"RadioButtonBar",
                    Enabled->Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {PrintingOptions, "FacingPages"}]]], 
                    StyleBox[
                    TogglerBox[Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageFace"}]], {Left->
                    DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabelSmall"], StandardForm]],
                     Left->
                    DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabelSmall"], 
                    StandardForm]]}, 
                    DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabelSmall"], StandardForm]],
                    Enabled->Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {PrintingOptions, "FacingPages"}]]],
                     "RadioButtonBarLabel",
                    StripOnInput->False]}
                    },
                    AutoDelete->False,
                    BaselinePosition->{1, 2},
                    
                    GridBoxAlignment->{
                    "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
                    GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.21]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}}], "  ", GridBox[{
                    {
                    RadioButtonBox[Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageFace"}]], {Right},
                    Appearance->Tiny,
                    BaselinePosition->1,
                    DefaultBaseStyle->"RadioButtonBar",
                    Enabled->Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {PrintingOptions, "FacingPages"}]]], 
                    StyleBox[
                    TogglerBox[Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageFace"}]], {Right->
                    DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabelSmall"], 
                    StandardForm]], Right->
                    DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabelSmall"], 
                    StandardForm]]}, 
                    DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabelSmall"], StandardForm]],
                    Enabled->Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {PrintingOptions, "FacingPages"}]]],
                     "RadioButtonBarLabel",
                    StripOnInput->False]}
                    },
                    AutoDelete->False,
                    BaselinePosition->{1, 2},
                    
                    GridBoxAlignment->{
                    "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
                    GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.21]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.4]}, 
                    Offset[0.2]}}]}], "Deploy"],
                   RadioButtonBar[
                    Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageFace"}]], {Left -> Toggler[
                    Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageFace"}]], {Left -> Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabelSmall"]], Left -> 
                    Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabelSmall"]]}, 
                    Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabelSmall"]], Enabled -> 
                    Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {PrintingOptions, "FacingPages"}]]],
                     Right -> Toggler[
                    Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageFace"}]], {Right -> Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabelSmall"]], Right -> 
                    Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabelSmall"]]}, 
                    Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabelSmall"]], Enabled -> 
                    Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FacingPages"}]]]}, Enabled -> Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {PrintingOptions, "FacingPages"}]], 
                    BaselinePosition -> 1, Appearance -> Tiny]]}], 
                 "\[SpanFromLeft]"},
                {
                 DynamicBox[ToBoxes[
                   FEPrivate`FrontEndResource[
                   "HeadersFootersDialog", "FirstPageText"], StandardForm]], 
                 RowBox[{
                  RowBox[{
                   CheckboxBox[Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageHeader"}]]], 
                   "\[InvisibleSpace]", 
                   TogglerBox[Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageHeader"}]], {True->
                    DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "HeaderLabel"], StandardForm]], 
                    False->
                    DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "HeaderLabel"], StandardForm]]}, 
                    DynamicBox[ToBoxes[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageHeader"}], StandardForm]]]}], 
                  TemplateBox[{5},
                   "Spacer1"], 
                  RowBox[{
                   CheckboxBox[Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageFooter"}]]], 
                   "\[InvisibleSpace]", 
                   TogglerBox[Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageFooter"}]], {True->
                    DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "FooterLabel"], StandardForm]], 
                    False->
                    DynamicBox[ToBoxes[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "FooterLabel"], StandardForm]]}, 
                    DynamicBox[ToBoxes[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageFooter"}], StandardForm]]]}]}]}
               },
               AutoDelete->False,
               GridBoxAlignment->{"Columns" -> {{Left}}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              "Grid"],
             ImageMargins->0]}
          },
          AutoDelete->False,
          BaselinePosition->{1, 1},
          GridBoxAlignment->{"Columns" -> {{Left}}},
          GridBoxBackground->{"Columns" -> {{Automatic}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{0.2}}, "Rows" -> {{0.5}}}]}, 
         Dynamic[$CellContext`open$$],
         Alignment->Automatic,
         BaseStyle->{},
         BaselinePosition->Baseline,
         DefaultBaseStyle->"OpenerView",
         ImageMargins->0,
         ImageSize->Automatic],
        Deployed->False,
        StripOnInput->False],
       OpenerView[{
         EventHandler[
          Dynamic[
           FEPrivate`FrontEndResource[
           "HeadersFootersDialog", "OptionsLabel"]], {
          "MouseClicked" :> ($CellContext`open$$ = 
            Not[$CellContext`open$$])}], 
         Grid[{{
            Dynamic[
             FEPrivate`FrontEndResource[
             "HeadersFootersDialog", "StartPageLabel"]], 
            InputField[
             Dynamic[
              CurrentValue[
               EvaluationNotebook[], PrintingStartingPageNumber]], Number, 
             FieldSize -> {{5, 10}, 1}]}, {
            Row[{
              Row[{
                Checkbox[
                 Dynamic[
                  CurrentValue[
                   EvaluationNotebook[], {PrintingOptions, "FacingPages"}]]], 
                Toggler[
                 Dynamic[
                  CurrentValue[
                   EvaluationNotebook[], {PrintingOptions, "FacingPages"}]], {
                 True -> Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "FacingLabel"]], False -> Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "FacingLabel"]]}]}, StripOnInput -> 
               True], 
              RadioButtonBar[
               Dynamic[
                CurrentValue[
                 EvaluationNotebook[], {PrintingOptions, "FirstPageFace"}]], {
               Left -> Toggler[
                  Dynamic[
                   CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageFace"}]], {Left -> Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabelSmall"]], Left -> 
                   Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "LeftLabelSmall"]]}, 
                  Dynamic[
                   FEPrivate`FrontEndResource[
                   "HeadersFootersDialog", "LeftLabelSmall"]], Enabled -> 
                  Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {PrintingOptions, "FacingPages"}]]],
                 Right -> Toggler[
                  Dynamic[
                   CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FirstPageFace"}]], {Right -> Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabelSmall"]], Right -> 
                   Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "RightLabelSmall"]]}, 
                  Dynamic[
                   FEPrivate`FrontEndResource[
                   "HeadersFootersDialog", "RightLabelSmall"]], Enabled -> 
                  Dynamic[
                    CurrentValue[
                    EvaluationNotebook[], {
                    PrintingOptions, "FacingPages"}]]]}, Enabled -> Dynamic[
                 CurrentValue[
                  EvaluationNotebook[], {PrintingOptions, "FacingPages"}]], 
               BaselinePosition -> 1, Appearance -> Tiny]}, StripOnInput -> 
             True], SpanFromLeft}, {
            Dynamic[
             FEPrivate`FrontEndResource[
             "HeadersFootersDialog", "FirstPageText"]], 
            Row[{
              Row[{
                Checkbox[
                 Dynamic[
                  CurrentValue[
                   EvaluationNotebook[], {
                   PrintingOptions, "FirstPageHeader"}]]], 
                Toggler[
                 Dynamic[
                  CurrentValue[
                   EvaluationNotebook[], {
                   PrintingOptions, "FirstPageHeader"}]], {True -> Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "HeaderLabel"]], False -> Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "HeaderLabel"]]}]}, StripOnInput -> 
               True], 
              Row[{
                Checkbox[
                 Dynamic[
                  CurrentValue[
                   EvaluationNotebook[], {
                   PrintingOptions, "FirstPageFooter"}]]], 
                Toggler[
                 Dynamic[
                  CurrentValue[
                   EvaluationNotebook[], {
                   PrintingOptions, "FirstPageFooter"}]], {True -> Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "FooterLabel"]], False -> Dynamic[
                    FEPrivate`FrontEndResource[
                    "HeadersFootersDialog", "FooterLabel"]]}]}, StripOnInput -> 
               True]}, 
             Spacer[5], StripOnInput -> True]}}, Alignment -> Left]}, 
        Dynamic[$CellContext`open$$]]], "\[SpanFromLeft]"},
     {
      TagBox[GridBox[{
         {
          ButtonBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["HeadersFootersDialog", "ResetLabel"],
              StandardForm],
            ImageSizeCache->{28., {0., 9.}}],
           Appearance->Automatic,
           ButtonFunction:>If[
             CurrentValue["ShiftKey"], FE`headersFootersDialog[
               CurrentValue[
                ButtonNotebook[], {TaggingRules, "InputNotebook"}]]; 
             DialogReturn[], 
             FE`headersFootersDialog[
              ButtonNotebook[], 
              CurrentValue[
               ButtonNotebook[], {TaggingRules, "InputNotebook"}]]],
           Evaluator->Automatic,
           ImageMargins->{{2, 2}, {10, 10}},
           ImageSize->FrontEnd`CurrentValue["DefaultButtonSize"],
           Method->"Preemptive"], 
          DynamicBox[ToBoxes[Notebooks[]; If[
              Not[
               NotebookTools`NotebookOpenQ[
                CurrentValue[
                 EvaluationNotebook[], {TaggingRules, "InputNotebook"}]]], 
              NotebookClose[
               EvaluationNotebook[]]]; "", StandardForm],
           ImageSizeCache->{0., {0., 6.}}]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], 
      StyleBox[
       DynamicBox[FEPrivate`FrontEndResource[
        "FEExpressions", "ChoiceButtonsOrder"][{
          ButtonBox[
           DynamicBox[
            FEPrivate`FrontEndResourceString["okButtonText"]], 
           ButtonFunction :> (FE`headersFootersDialog[
              CurrentValue[
               ButtonNotebook[], {TaggingRules, "InputNotebook"}], 
              ButtonNotebook[], True]; DialogReturn[]), Appearance -> 
           "DefaultButton", Evaluator -> Automatic, Method -> "Preemptive"], 
          ButtonBox[
           DynamicBox[
            FEPrivate`FrontEndResourceString["cancelButtonText"]], 
           ButtonFunction :> DialogReturn[$Canceled], Appearance -> 
           "CancelButton", Evaluator -> Automatic, Method -> "Preemptive"]}],
        ImageSizeCache->{192., {20., 26.}}],
       Deployed->True,
       DynamicUpdating->True,
       ButtonBoxOptions->{ImageMargins->{{2, 2}, {10, 10}},
       ImageSize->Dynamic[
         CurrentValue["DefaultButtonSize"]]},
       GridBoxOptions->{AutoDelete->False,
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}}]}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {Left, Right}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"],
  DynamicModuleValues:>{{
    DownValues[$CellContext`currentPosition$$] = {HoldPattern[
         $CellContext`currentPosition$$[1, "Footer"]] :> 1, HoldPattern[
         $CellContext`currentPosition$$[1, "Header"]] :> 1, HoldPattern[
         $CellContext`currentPosition$$[2, "Footer"]] :> 3, HoldPattern[
         $CellContext`currentPosition$$[2, "Header"]] :> 3}}},
  Initialization:>($CellContext`currentPage$$ = 
    1; $CellContext`currentPosition$$[1, "Header"] = 
    1; $CellContext`currentPosition$$[1, "Footer"] = 
    1; $CellContext`currentPosition$$[2, "Header"] = 
    3; $CellContext`currentPosition$$[2, "Footer"] = 3; If[
     Not[
      MatchQ[
       CurrentValue[
       FrontEnd`$FrontEnd, {
        PrivateFrontEndOptions, "DialogSettings", "HeadersFooters", 
         "PageNumberFormat"}], 
       Alternatives[
        Except[Inherited, 
         Blank[Symbol]], 
        Blank[Function]]]], 
     CurrentValue[
      FrontEnd`$FrontEnd, {
       PrivateFrontEndOptions, "DialogSettings", "HeadersFooters", 
        "PageNumberFormat"}] = Identity]; If[
     Not[
      MatchQ[
       CurrentValue[
       FrontEnd`$FrontEnd, {
        PrivateFrontEndOptions, "DialogSettings", "HeadersFooters", 
         "DateFormat"}], 
       StyleBox[
        Blank[], TaggingRules -> {"Date", 
          Blank[]}]]], 
     CurrentValue[
      FrontEnd`$FrontEnd, {
       PrivateFrontEndOptions, "DialogSettings", "HeadersFooters", 
        "DateFormat"}] = StyleBox[
       ValueBox["Date"], TaggingRules -> {"Date", 1}]]; Null)]],
 CellMargins->{{8, 8}, {8, 8}},
 CellBracketOptions->{"Color"->RGBColor[0.269993, 0.308507, 0.6]},
 CellHorizontalScrolling->True,
 PageBreakAbove->True,
 PageBreakWithin->False,
 ShowAutoStyles->True,
 LineSpacing->{1.25, 0},
 AutoItalicWords->{},
 ScriptMinSize->9,
 ShowStringCharacters->False,
 FontFamily:>CurrentValue["PanelFontFamily"],
 FontSize:>CurrentValue[
  "PanelFontSize"],ExpressionUUID->"c31f7e20-270e-4a1b-a949-b2a87bf05dd7"]
},
Evaluator->"System",
NotebookEventActions->{"ReturnKeyDown" :> FE`Evaluate[
    FEPrivate`FindAndClickDefaultButton[]], {
   "MenuCommand", "HandleShiftReturn"} :> FE`Evaluate[
    FEPrivate`FindAndClickDefaultButton[]], {
   "MenuCommand", "EvaluateCells"} :> (None; {}), {
   "MenuCommand", "SimilarCellBelow"} :> (None; {}), "WindowClose" :> 
  FE`Evaluate[
    FEPrivate`FindAndClickCancelButton[]], "EscapeKeyDown" :> If[
    Not[
     CurrentValue["ShiftKey"]], 
    FE`Evaluate[
     FEPrivate`FindAndClickCancelButton[]]], PassEventsDown -> True},
WindowSize->All,
WindowMargins->{{779, Automatic}, {Automatic, 282}},
WindowFrame->"ModelessDialog",
PageHeaders->{{None, None, None}, {None, None, None}},
CellContext->"Global`",
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (December 25, 2018)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "SystemDialog.nb"]], 
   Cell[
    StyleData["Header"], FontSize -> 
    FrontEnd`CurrentValue[{"ControlsFontSize", Small}]], 
   Cell[
    StyleData["Footer"], FontSize -> 
    FrontEnd`CurrentValue[{"ControlsFontSize", Small}]], 
   Cell[
    StyleData["PageNumber"], FontSize -> 
    FrontEnd`CurrentValue[{"ControlsFontSize", Small}], FontSlant -> Plain], 
   Cell[
    StyleData["Placeholder"], Background -> None, 
    FrameBoxOptions -> {
     Background -> RGBColor[1., 0.9724879835202563, 0.7976806286717022], 
      FrameMargins -> {{5, 5}, {0, 0}}, RoundingRadius -> 5}], 
   Cell[
    StyleData["TextStyleInputField"], 
    CounterBoxOptions -> {
     CounterFunction :> (FEPrivate`StringJoin[
       "\[LeftGuillemet]", #2, "\[RightGuillemet]"]& )}, 
    ValueBoxOptions -> {
     DisplayFunction :> (FEPrivate`StringJoin[
       "\[LeftGuillemet]", #2, "\[RightGuillemet]"]& )}, 
    OptionValueBoxOptions -> {
     DisplayFunction :> (FEPrivate`StringJoin[
       "\[LeftGuillemet]", #2, "\[RightGuillemet]"]& )}], 
   Cell[
    StyleData["SelectionHighlight"], ContextMenu -> None, 
    TooltipBoxOptions -> {TooltipDelay -> Automatic}], 
   Cell[
    StyleData["SelectedHighlight"], ContextMenu -> 
    FEPrivate`FrontEndResource["ContextMenus", "HeadersFooters"]]}, Visible -> 
  False, FrontEndVersion -> 
  "12.0 for Microsoft Windows (64-bit) (December 25, 2018)", StyleDefinitions -> 
  "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[566, 20, 298107, 6321, 445, InheritFromParent,ExpressionUUID->"c31f7e20-270e-4a1b-a949-b2a87bf05dd7",
 PageBreakAbove->True,
 PageBreakWithin->False]
}
]
*)

(* End of internal cache information *)

